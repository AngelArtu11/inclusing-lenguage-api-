<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="InclusingLenguage._03_Views.LessonPage"
             Title="Lección"
             BackgroundColor="#00131F">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header con progreso de la lección -->
        <Frame Grid.Row="0" 
               BackgroundColor="#002132" 
               CornerRadius="0,0,20,20" 
               Padding="20,15,20,20" 
               HasShadow="True"
               Margin="0,0,0,10">

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Botón Atrás -->
                <Frame Grid.Column="0" 
                       BackgroundColor="#00577D" 
                       CornerRadius="20" 
                       Padding="10"
                       HeightRequest="40"
                       WidthRequest="40"
                       HasShadow="False">
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnBackTapped"/>
                    </Frame.GestureRecognizers>
                    <Label Text="←" 
                           FontSize="20" 
                           TextColor="White" 
                           HorizontalOptions="Center" 
                           VerticalOptions="Center"/>
                </Frame>

                <!-- Progreso de ejercicios -->
                <StackLayout Grid.Column="1" 
                            Spacing="8" 
                            VerticalOptions="Center"
                            Margin="15,0">
                    <Label x:Name="LessonTitleLabel" 
                           Text="Letra A" 
                           FontSize="18" 
                           FontAttributes="Bold" 
                           TextColor="White"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <ProgressBar x:Name="LessonProgressBar" 
                                     Grid.Column="0"
                                     Progress="0.33" 
                                     ProgressColor="#13B7FF" 
                                     BackgroundColor="#00577D"
                                     HeightRequest="8"
                                     VerticalOptions="Center"/>

                        <Label x:Name="ProgressLabel" 
                               Grid.Column="1"
                               Text="1/3" 
                               FontSize="13" 
                               TextColor="#86CBFF"
                               Margin="10,0,0,0"
                               VerticalOptions="Center"/>
                    </Grid>
                </StackLayout>

                <!-- XP de la lección -->
                <Frame Grid.Column="2" 
                       BackgroundColor="#00ABE8" 
                       CornerRadius="15" 
                       Padding="10,8"
                       HasShadow="False">
                    <StackLayout Orientation="Horizontal" Spacing="5">
                        <Label Text="⚡" FontSize="16"/>
                        <Label x:Name="LessonXPLabel" 
                               Text="10" 
                               FontSize="14" 
                               FontAttributes="Bold" 
                               TextColor="White"
                               VerticalOptions="Center"/>
                    </StackLayout>
                </Frame>

            </Grid>
        </Frame>

        <!-- Contenido principal de la lección -->
        <ScrollView Grid.Row="1">
            <StackLayout x:Name="ExerciseContainer" 
                        Padding="20" 
                        Spacing="20">

                <!-- Contenedor dinámico para diferentes tipos de ejercicios -->

                <!-- Tipo 1: Práctica (Ver y Aprender) -->
                <StackLayout x:Name="PracticeExercise" IsVisible="True" Spacing="20">

                    <Frame BackgroundColor="#002132" 
                           BorderColor="#0073A3"
                           CornerRadius="20" 
                           Padding="25"
                           HasShadow="True">

                        <StackLayout Spacing="20">
                            <!-- Título del ejercicio -->
                            <Label x:Name="ExerciseQuestionLabel" 
                                   Text="Aprende la seña de la letra A" 
                                   FontSize="20" 
                                   FontAttributes="Bold" 
                                   TextColor="White"
                                   HorizontalTextAlignment="Center"/>

                            <!-- Imagen/GIF de la seña -->
                            <Frame BackgroundColor="#00131F" 
                                   CornerRadius="20" 
                                   Padding="0"
                                   HeightRequest="300"
                                   HasShadow="False">
                                <Grid>
                                    <!-- Placeholder para imagen -->
                                    <Label x:Name="SignEmojiLabel"
                                       Text="🤟" 
                                      FontSize="120" 
                                      HorizontalOptions="Center" 
                                      VerticalOptions="Center"
                                      TextColor="#13B7FF"/>

                                    <Label x:Name="SignImagePlaceholder"
                                           Text="Imagen de la seña A" 
                                           FontSize="16" 
                                           TextColor="#86CBFF"
                                           HorizontalOptions="Center" 
                                           VerticalOptions="End"
                                           Margin="0,0,0,20"/>
                                </Grid>
                            </Frame>

                            <!-- Descripción -->
                            <Frame BackgroundColor="#00577D" 
                                   CornerRadius="15" 
                                   Padding="15"
                                   HasShadow="False">
                                <StackLayout Spacing="10">
                                    <Label Text="💡 Cómo hacerlo:" 
                                           FontSize="16" 
                                           FontAttributes="Bold" 
                                           TextColor="#13B7FF"/>
                                    <Label x:Name="DescriptionLabel" 
                                           Text="1. Cierra el puño completamente&#10;2. Mantén el pulgar a un lado&#10;3. Los dedos deben apuntar hacia arriba" 
                                           FontSize="15" 
                                           TextColor="#C4E2FF"
                                           LineHeight="1.4"/>
                                </StackLayout>
                            </Frame>

                            <!-- Video tutorial (simulado) -->
                            <Frame BackgroundColor="#13B7FF" 
                                   CornerRadius="15" 
                                   Padding="15"
                                   HasShadow="True">
                                <Frame.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="OnPlayVideoTapped"/>
                                </Frame.GestureRecognizers>
                                <StackLayout Orientation="Horizontal" 
                                            Spacing="10"
                                            HorizontalOptions="Center">
                                    <Label Text="▶️" FontSize="20"/>
                                    <Label Text="Ver video tutorial" 
                                           FontSize="16" 
                                           FontAttributes="Bold" 
                                           TextColor="White"
                                           VerticalOptions="Center"/>
                                </StackLayout>
                            </Frame>

                        </StackLayout>
                    </Frame>

                </StackLayout>

                <!-- Tipo 2: Opción Múltiple -->
                <StackLayout x:Name="MultipleChoiceExercise" IsVisible="False" Spacing="20">

                    <Frame BackgroundColor="#002132" 
                           BorderColor="#0073A3"
                           CornerRadius="20" 
                           Padding="25"
                           HasShadow="True">

                        <StackLayout Spacing="25">
                            <!-- Pregunta -->
                            <Label x:Name="MCQuestionLabel" 
                                   Text="¿Cuál es la seña correcta para la letra A?" 
                                   FontSize="20" 
                                   FontAttributes="Bold" 
                                   TextColor="White"
                                   HorizontalTextAlignment="Center"/>

                            <!-- Imagen de referencia -->
                            <Frame BackgroundColor="#00131F" 
                                   CornerRadius="15" 
                                   Padding="20"
                                   HeightRequest="200"
                                   HasShadow="False">
                                <Label Text="🤟" 
                                       FontSize="100" 
                                       HorizontalOptions="Center" 
                                       VerticalOptions="Center"
                                       TextColor="#13B7FF"/>
                            </Frame>

                            <!-- Opciones -->
                            <StackLayout x:Name="OptionsContainer" Spacing="12">

                                <Frame x:Name="Option1" 
                                       BackgroundColor="#00577D" 
                                       BorderColor="#0073A3"
                                       CornerRadius="15" 
                                       Padding="20"
                                       HasShadow="True">
                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="A"/>
                                    </Frame.GestureRecognizers>
                                    <Label Text="A) Letra A" 
                                           FontSize="18" 
                                           TextColor="White"/>
                                </Frame>

                                <Frame x:Name="Option2" 
                                       BackgroundColor="#00577D" 
                                       BorderColor="#0073A3"
                                       CornerRadius="15" 
                                       Padding="20"
                                       HasShadow="True">
                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="B"/>
                                    </Frame.GestureRecognizers>
                                    <Label Text="B) Letra B" 
                                           FontSize="18" 
                                           TextColor="White"/>
                                </Frame>

                                <Frame x:Name="Option3" 
                                       BackgroundColor="#00577D" 
                                       BorderColor="#0073A3"
                                       CornerRadius="15" 
                                       Padding="20"
                                       HasShadow="True">
                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="C"/>
                                    </Frame.GestureRecognizers>
                                    <Label Text="C) Letra C" 
                                           FontSize="18" 
                                           TextColor="White"/>
                                </Frame>

                                <Frame x:Name="Option4" 
                                       BackgroundColor="#00577D" 
                                       BorderColor="#0073A3"
                                       CornerRadius="15" 
                                       Padding="20"
                                       HasShadow="True">
                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="D"/>
                                    </Frame.GestureRecognizers>
                                    <Label Text="D) Letra D" 
                                           FontSize="18" 
                                           TextColor="White"/>
                                </Frame>

                            </StackLayout>

                            <!-- Hint -->
                            <Frame x:Name="HintFrame" 
                                   IsVisible="False"
                                   BackgroundColor="#FFD700" 
                                   CornerRadius="15" 
                                   Padding="15"
                                   HasShadow="False">
                                <StackLayout Orientation="Horizontal" Spacing="10">
                                    <Label Text="💡" FontSize="20"/>
                                    <Label x:Name="HintLabel" 
                                           Text="Recuerda: el pulgar debe estar a un lado" 
                                           FontSize="14" 
                                           TextColor="#00131F"
                                           VerticalOptions="Center"
                                           LineBreakMode="WordWrap"/>
                                </StackLayout>
                            </Frame>

                        </StackLayout>
                    </Frame>

                </StackLayout>

                <!-- Feedback de respuesta -->
                <Frame x:Name="FeedbackFrame" 
                       IsVisible="False"
                       CornerRadius="15" 
                       Padding="20"
                       HasShadow="True">
                    <StackLayout Spacing="15">
                        <StackLayout Orientation="Horizontal" 
                                    Spacing="10"
                                    HorizontalOptions="Center">
                            <Label x:Name="FeedbackIcon" 
                                   Text="✅" 
                                   FontSize="30"/>
                            <Label x:Name="FeedbackTitle" 
                                   Text="¡Correcto!" 
                                   FontSize="24" 
                                   FontAttributes="Bold"
                                   VerticalOptions="Center"/>
                        </StackLayout>

                        <Label x:Name="FeedbackMessage" 
                               Text="¡Excelente trabajo! Has identificado correctamente la letra A." 
                               FontSize="16"
                               HorizontalTextAlignment="Center"
                               LineHeight="1.3"/>

                        <Label x:Name="FeedbackXP" 
                               Text="+10 XP" 
                               FontSize="20" 
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                    </StackLayout>
                </Frame>

            </StackLayout>
        </ScrollView>

        <!-- Botones de navegación -->
        <Frame Grid.Row="2" 
               BackgroundColor="#002132" 
               CornerRadius="20,20,0,0" 
               Padding="20,15,20,20" 
               HasShadow="True">

            <Grid ColumnSpacing="15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Botón Pista -->
                <Button x:Name="HintButton" 
                        Grid.Column="0"
                        Text="💡 Pista" 
                        BackgroundColor="#00577D" 
                        TextColor="White" 
                        BorderColor="#0073A3"
                        BorderWidth="2"
                        CornerRadius="15" 
                        HeightRequest="55"
                        FontSize="16"
                        FontAttributes="Bold"
                        Clicked="OnHintClicked"/>

                <!-- Botón Continuar/Siguiente -->
                <Button x:Name="NextButton" 
                        Grid.Column="1"
                        Text="Continuar" 
                        BackgroundColor="#13B7FF" 
                        TextColor="White" 
                        CornerRadius="15" 
                        HeightRequest="55"
                        FontSize="16"
                        FontAttributes="Bold"
                        Clicked="OnNextClicked">
                    <Button.Shadow>
                        <Shadow Brush="#13B7FF" 
                                Offset="0,4" 
                                Radius="10" 
                                Opacity="0.3"/>
                    </Button.Shadow>
                </Button>

            </Grid>
        </Frame>

    </Grid>
</ContentPage>